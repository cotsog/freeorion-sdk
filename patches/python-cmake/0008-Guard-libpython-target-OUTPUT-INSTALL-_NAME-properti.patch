From 70f52185bb761d6603bd785a076d6e1041d40815 Mon Sep 17 00:00:00 2001
From: Marcel Metz <mmetz@adrian-broher.net>
Date: Wed, 14 Sep 2016 18:16:27 +0200
Subject: [PATCH] Guard libpython target {OUTPUT,INSTALL}_NAME properties

They may conflict with the framework creation on MacOSX.
---
 cmake/libpython/CMakeLists.txt | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/cmake/libpython/CMakeLists.txt b/cmake/libpython/CMakeLists.txt
index b8e9a74..75f483a 100644
--- a/cmake/libpython/CMakeLists.txt
+++ b/cmake/libpython/CMakeLists.txt
@@ -454,10 +454,8 @@ function(add_libpython name type install component)
     endif()
 
     set_target_properties(${name} PROPERTIES
-        OUTPUT_NAME ${LIBPYTHON}${ABIFLAGS}
         LIBRARY_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/${LIBPYTHON_LIBDIR}
         RUNTIME_OUTPUT_DIRECTORY ${PROJECT_BINARY_DIR}/${LIBPYTHON_LIBDIR}
-        INSTALL_NAME_DIR ${CMAKE_INSTALL_PREFIX}/${LIBPYTHON_LIBDIR}
         PUBLIC_HEADER "${LIBPYTHON_HEADERS}"
     )
     if(HAVE_POSITION_INDEPENDENT_CODE)
@@ -479,6 +477,11 @@ function(add_libpython name type install component)
             XCODE_ATTRIBUTE_INSTALL_PATH "@rpath"
             OUTPUT_NAME Python
         )
+    else()
+        set_target_properties(${name} PROPERTIES
+            OUTPUT_NAME ${LIBPYTHON}${ABIFLAGS}
+            INSTALL_NAME_DIR ${CMAKE_INSTALL_PREFIX}/${LIBPYTHON_LIBDIR}
+        )
     endif()
 
     if(install)
-- 
2.7.4

